<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Workflow tips · Cleaner.jl</title><script data-outdated-warner src="../../assets/warner.js"></script><link rel="canonical" href="https://TheRoniOne.github.io/Cleaner.jl/man/workflow_tips/"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">Cleaner.jl</a></span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">Guide</span><ul><li><a class="tocitem" href="../first_steps/">First steps</a></li><li><a class="tocitem" href="../name_changing/">A name-changing help</a></li><li><a class="tocitem" href="../dirt_removal/">Getting the dirt out</a></li><li class="is-active"><a class="tocitem" href>Workflow tips</a><ul class="internal"><li><a class="tocitem" href="#Starting-the-workflow"><span>Starting the workflow</span></a></li><li><a class="tocitem" href="#Looking-for-performance"><span>Looking for performance</span></a></li><li><a class="tocitem" href="#Looking-for-convenience"><span>Looking for convenience</span></a></li><li><a class="tocitem" href="#Final-touches"><span>Final touches</span></a></li></ul></li></ul></li><li><span class="tocitem">API</span><ul><li><a class="tocitem" href="../../lib/types/">Types</a></li><li><a class="tocitem" href="../../lib/functions/">Functions</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Guide</a></li><li class="is-active"><a href>Workflow tips</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Workflow tips</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/TheRoniOne/Cleaner.jl/blob/master/docs/src/man/workflow_tips.md#" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Workflow-tips"><a class="docs-heading-anchor" href="#Workflow-tips">Workflow tips</a><a id="Workflow-tips-1"></a><a class="docs-heading-anchor-permalink" href="#Workflow-tips" title="Permalink"></a></h1><h2 id="Starting-the-workflow"><a class="docs-heading-anchor" href="#Starting-the-workflow">Starting the workflow</a><a id="Starting-the-workflow-1"></a><a class="docs-heading-anchor-permalink" href="#Starting-the-workflow" title="Permalink"></a></h2><p>Usually you will start by having a <a href="https://github.com/JuliaData/Tables.jl">Tables.jl</a> implementation loaded with the data you want to work with, so your next step could be to use a non-mutating <code>Cleaner</code> function to start your <code>Cleaner</code> workflow.</p><pre><code class="language-julia-repl">julia&gt; using DataFrames: DataFrame

julia&gt; using Cleaner

julia&gt; df = DataFrame(&quot; Some bad Name&quot; =&gt; [missing, missing, missing], &quot;Another_weird name &quot; =&gt; [1, &quot;x&quot;, 3])
3×2 DataFrame
 Row │  Some bad Name  Another_weird name
     │ Missing         Any
─────┼─────────────────────────────────────
   1 │        missing  1
   2 │        missing  x
   3 │        missing  3

julia&gt; ct = polish_names(df)
┌───────────────┬────────────────────┐
│ some_bad_name │ another_weird_name │
│       Missing │                Any │
├───────────────┼────────────────────┤
│       missing │                  1 │
│       missing │                  x │
│       missing │                  3 │
└───────────────┴────────────────────┘

</code></pre><p>After that, you can decide whether to continue using non-mutating functions or start using mutating ones.</p><pre><code class="language-julia-repl">julia&gt; ct |&gt; compact_columns |&gt; reinfer_schema
┌────────────────────┐
│ another_weird_name │
│   U{Int64, String} │
├────────────────────┤
│                  1 │
│                  x │
│                  3 │
└────────────────────┘


julia&gt; ct
┌───────────────┬────────────────────┐
│ some_bad_name │ another_weird_name │
│       Missing │                Any │
├───────────────┼────────────────────┤
│       missing │                  1 │
│       missing │                  x │
│       missing │                  3 │
└───────────────┴────────────────────┘


julia&gt; ct |&gt; compact_columns! |&gt; reinfer_schema!
┌────────────────────┐
│ another_weird_name │
│   U{Int64, String} │
├────────────────────┤
│                  1 │
│                  x │
│                  3 │
└────────────────────┘


julia&gt; ct
┌────────────────────┐
│ another_weird_name │
│   U{Int64, String} │
├────────────────────┤
│                  1 │
│                  x │
│                  3 │
└────────────────────┘

</code></pre><p>Depending on what you are trying to do, one could be a better option than the other. For example, if you need to keep copies of the data in order to do different transformations between copies, using non-mutating functions would be a better fit, whereas if you just want to do a series of linear transformations on your data and continue processing it after finishing the cleaning, using mutating functions would a better option.</p><p>You could also mix and match mutating and non-mutating <code>Cleaner</code> functions to better fit your needs, as all non-mutating <code>Cleaner</code> functions work on any <a href="https://github.com/JuliaData/Tables.jl">Tables.jl</a> implementation and return a <code>CleanTable</code>, while all mutating <code>Cleaner</code> functions work on a <code>CleanTable</code> and return a <code>CleanTable</code> which also is a Tables.jl implementation.</p><p>There is also the option to build a <code>CleanTable</code> from any Tables.jl implementation to start a your workflow by mutating even the data stored in the original table, as the <code>CleanTable</code> constructor has a keyword argument <code>copycols</code> that can be set to false to use the original columns directly at your own risk.</p><pre><code class="language-julia-repl">julia&gt; ct = CleanTable(df; copycols=false) |&gt; polish_names! |&gt; compact_columns!
┌────────────────────┐
│ another_weird_name │
│                Any │
├────────────────────┤
│                  1 │
│                  x │
│                  3 │
└────────────────────┘


julia&gt; ct.another_weird_name[2] = 4
4

julia&gt; ct
┌────────────────────┐
│ another_weird_name │
│                Any │
├────────────────────┤
│                  1 │
│                  4 │
│                  3 │
└────────────────────┘


julia&gt; df
3×2 DataFrame
 Row │  Some bad Name  Another_weird name
     │ Missing         Any
─────┼─────────────────────────────────────
   1 │        missing  1
   2 │        missing  4
   3 │        missing  3
</code></pre><p>The complete oposite approach would be to use a function from the ROT (returning original type) variants (e.g. <code>polish_names_ROT</code>) that take as input any table, does it&#39;s transformation on a copy of it and then returns a new table of the same type of the source table.</p><pre><code class="language-julia-repl">julia&gt; df |&gt; polish_names_ROT
3×2 DataFrame
 Row │ some_bad_name  another_weird_name
     │ Missing        Any
─────┼───────────────────────────────────
   1 │       missing  1
   2 │       missing  4
   3 │       missing  3
</code></pre><h2 id="Looking-for-performance"><a class="docs-heading-anchor" href="#Looking-for-performance">Looking for performance</a><a id="Looking-for-performance-1"></a><a class="docs-heading-anchor-permalink" href="#Looking-for-performance" title="Permalink"></a></h2><p>When trying to avoid most of the extra allocations while working with <code>Cleaner</code>, you should start by creating a <code>CleanTable</code> specifying <code>copycols=false</code> to use the original columns directly on the new <code>CleanTable</code> instead of having a non-mutating <code>Cleaner</code> function making copies of them to use on the <code>CleanTable</code> it builds first.</p><pre><code class="language-julia-repl">julia&gt; nt = (A = [missing, missing, missing], B = [4, &#39;x&#39;, 6])
(A = [missing, missing, missing], B = Any[4, &#39;x&#39;, 6])

julia&gt; ct = CleanTable(nt; copycols=false)
┌─────────┬─────┐
│       A │   B │
│ Missing │ Any │
├─────────┼─────┤
│ missing │   4 │
│ missing │   x │
│ missing │   6 │
└─────────┴─────┘

</code></pre><p>Now that you have a <code>CleanTable</code> you should continue by using <code>Cleaner</code> mutating functions, as they will modify the same <code>CleanTable</code> passed as input in place avoiding having to allocate new <code>CleanTable</code>s while also avoiding copying the underlying columns data.</p><pre><code class="language-julia-repl">julia&gt; compact_columns!(ct)
┌─────┐
│   B │
│ Any │
├─────┤
│   4 │
│   x │
│   6 │
└─────┘


julia&gt; row_as_names!(ct, 2)
┌─────┐
│   x │
│ Any │
├─────┤
│   6 │
└─────┘


julia&gt; ct
┌─────┐
│   x │
│ Any │
├─────┤
│   6 │
└─────┘


julia&gt; nt
(A = [missing, missing, missing], B = Any[6])
</code></pre><div class="admonition is-warning"><header class="admonition-header">Warning</header><div class="admonition-body"><p>Note that when using the original columns to build a <code>CleanTable</code> and using mutating functions in it, the changes also happen on the source potentially corrupting it.</p><p>If you do need to use the original source after applying mutating <code>Cleaner</code> functions, you can always just use a non-mutating  <code>Cleaner</code> function first to have it create a <code>CleanTable</code> with copied columns first and do its transformation on it and then  continue by using mutating <code>Cleaner</code> functions for performance.</p></div></div><h2 id="Looking-for-convenience"><a class="docs-heading-anchor" href="#Looking-for-convenience">Looking for convenience</a><a id="Looking-for-convenience-1"></a><a class="docs-heading-anchor-permalink" href="#Looking-for-convenience" title="Permalink"></a></h2><p>If you just want to apply a <code>Cleaner</code> function or two on your original table, probably you also want to have the result be of the original table type. For this cases we have the convinient ROT function variants, that will keep the original columns intact by applying the transformation on a new <code>CleanTable</code> with copied columns and return a new table based on the result but having it be of the original source type.</p><pre><code class="language-julia-repl">julia&gt; df = DataFrame(&quot;A&quot; =&gt; [missing, missing, missing], &quot;B&quot; =&gt; [4, &#39;x&#39;, 6])
3×2 DataFrame
 Row │ A        B
     │ Missing  Any
─────┼──────────────
   1 │ missing  4
   2 │ missing  x
   3 │ missing  6

julia&gt; df2 = compact_columns_ROT(df)
3×1 DataFrame
 Row │ B
     │ Any
─────┼─────
   1 │ 4
   2 │ x
   3 │ 6

julia&gt; df3 = row_as_names_ROT(df2, 2)
1×1 DataFrame
 Row │ x
     │ Any
─────┼─────
   1 │ 6
</code></pre><p>Its not recommended to use more than 2 ROT functions on a workflow, as they are the least performant and most allocating function variants. For each time a ROT function is called, it first is creating a <code>CleanTable</code> with copied columns to work with, then applying the desired transformation and then creating a new table of the original source type which commonly copies columns too.</p><p>This ends up allocating a new <code>CleanTable</code>, copying columns, allocating another table of the original source type and copying columns for it to use too for every time a ROT function is used, which when working with bigger tables can become slow and trigger a lot more times the garbage collector as compared by using an alternative workflow.</p><h2 id="Final-touches"><a class="docs-heading-anchor" href="#Final-touches">Final touches</a><a id="Final-touches-1"></a><a class="docs-heading-anchor-permalink" href="#Final-touches" title="Permalink"></a></h2><p>After using all the <code>CleanTable</code> functions you needed, you probably want to have the result be another table type to continue your workflow. For this cases, you can try calling the constructor of your desired table type to try and build a new table based on the output or, if you are not sure if your desired table type has a constructor that works with other table implementations, you can use the <code>materializer</code> function from <a href="https://github.com/JuliaData/Tables.jl">Tables.jl</a> we conveniently export for you.</p><pre><code class="language-julia-repl">julia&gt; df = DataFrame(&quot;A&quot; =&gt; [missing, missing, missing], &quot;B&quot; =&gt; [4, &#39;x&#39;, 6])
3×2 DataFrame
 Row │ A        B
     │ Missing  Any
─────┼──────────────
   1 │ missing  4
   2 │ missing  x
   3 │ missing  6

julia&gt; ct = compact_columns(df);

julia&gt; row_as_names!(ct, 2);

julia&gt; DataFrame(ct)
1×1 DataFrame
 Row │ x
     │ Any
─────┼─────
   1 │ 6

julia&gt; materializer(df)(ct)
1×1 DataFrame
 Row │ x
     │ Any
─────┼─────
   1 │ 6
</code></pre><p>If you are looking to get the most performance, some table types also let you call their constructor having it use the original columns so this way you could avoid some extra allocations.</p><pre><code class="language-julia-repl">julia&gt; df2 = DataFrame(ct; copycols=false)
1×1 DataFrame
 Row │ x
     │ Any
─────┼─────
   1 │ 6

julia&gt; df2.x[1] = 3
3

julia&gt; df2
1×1 DataFrame
 Row │ x
     │ Any
─────┼─────
   1 │ 3

julia&gt; ct
┌─────┐
│   x │
│ Any │
├─────┤
│   3 │
└─────┘

</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../dirt_removal/">« Getting the dirt out</a><a class="docs-footer-nextpage" href="../../lib/types/">Types »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Saturday 5 February 2022 17:14">Saturday 5 February 2022</span>. Using Julia version 1.7.1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
